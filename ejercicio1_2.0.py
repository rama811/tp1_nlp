import requests
from bs4 import BeautifulSoup
import pandas as pd

def web_scraping(url):
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')

    titulo = soup.find_all('h1', {'class': "main-title font-900"})
    titulo = titulo[0].text

    cuerpo_texto = soup.find('div', {'class': "article-body"})
    parrafos = cuerpo_texto.find_all('p')
    letra = '\n'.join(par.text for par in parrafos)

    return titulo, letra

def construir_dataset(categoria, urls):
    data = {"URL": [], "Titulo": [], "Texto": []}

    for url in urls:
        titulo, letra = web_scraping(url)
        data["URL"].append(url)
        data["Titulo"].append(titulo)
        data["Texto"].append(letra)

    df = pd.DataFrame(data)
    df["Categor√≠a"] = categoria
    return df


urls_policiales = ["https://www.rosario3.com/noticias/Un-muerto-y-un-herido-grave-en-un-ataque-a-balazos-en-plena-tarde-20190515-0052.html","https://www.rosario3.com/noticias/Una-mujer-se-desperto-con-cuatro-ladrones-en-su-casa-de-zona-noroeste-20190515-0011.html","https://www.rosario3.com/noticias/Homicidio-en-Perez-puso-en-fuga-a-un-ladron-que-luego-volvio-y-lo-mato---20190516-0008.html","https://www.rosario3.com/noticias/Violenta-agresion-de-un-cuidacoche-a-una-chica-en-un-local-20190516-0052.html","https://www.rosario3.com/noticias/Violenta-entradera-a-una-mujer-de-90-anos-se-sentaron-sobre-su-abdomen-20190516-0043.html","https://www.rosario3.com/policiales/Encontraron-el-cuerpo-de-un-hombre-en-la-bajada-El-Espinillo-tenia-una-herida-de-bala-en-el-abdomen-20231015-0035.html","https://www.rosario3.com/policiales/Multiples-allanamientos-y-cuatro-detenidos-por-amenazas-y-extorsiones-digitadas-desde-la-carcel-de-Pinero-20231018-0055.html","https://www.rosario3.com/policiales/Familiares-y-amigos-de-Ivana-se-unieron-para-reclamar-justicia-mientras-imputaban-al-primer-sospechoso-del-crimen-las-imagenes-20231018-0077.html","https://www.rosario3.com/policiales/Robaron-un-kiosco-del-microcentro-se-llevaron-magro-botin-y-lo-peor-para-el-dueno-fue-reponer-el-cristal-roto-20231018-0085.html","https://www.rosario3.com/policiales/Piden-perpetua-para-Claudio-Morocho-Mansilla-por-tres-asesinatos-ordenados-desde-la-carcel-de-Pinero-20231023-0042.html","https://www.rosario3.com/policiales/Recuperaron-celulares-robados-durante-el-Festival-Bandera-y-la-Fiscalia-convoca-a-reconocerlos-20231019-0035.html","https://www.rosario3.com/policiales/Robos-con-inhibidores-cayo-en-Pichincha-ladron-oriundo-de-Cordoba-con-la-temible-llave-Pandora-20231019-0042.html","https://www.rosario3.com/policiales/Brilloni-defendio-al-operador-del-911-que-intervino-en-el-crimen-de-Ivana-Mientras-dure-la-investigacion-seguira-trabajando-20231020-0009.html","https://www.rosario3.com/policiales/Condenaron-al-sicario-de-la-banda-de-Alan-Funes-que-esperaba-la-oportunidad-de-integrar-la-organizacion-20231020-0019.html","https://www.rosario3.com/policiales/Arrebato-persecucion-y-dos-motochorros-detenidos-con-dos-pistolas-20231020-0027.html","https://www.rosario3.com/policiales/Crimen-de-Ivana-el-abogado-de-la-familia-revelo-detalles-el-tercer-involucrado-20231020-0025.html","https://www.rosario3.com/policiales/Picada-mortal-en-la-que-murieron-David-y-Valentino-Pizorno-extienden-hasta-diciembre-la-prision-preventiva-de-los-imputados-20231020-0032.html","https://www.rosario3.com/policiales/El-jefe-de-sicarios-de-Esteban-Alvarado-desaparecio-de-la-carcel-de-Devoto-buscan-determinar-si-se-fugo-20231020-0061.html", "https://www.rosario3.com/policiales/Paradero-desconocido-las-versiones-sobre-la-desaparicion-de-Mauricio-Laferrara-de-la-carcel-de-Devoto-20231021-0013.html", "https://www.rosario3.com/policiales/La-carrera-criminal-de-un-tiratiros-del-Cordon-Industrial-imputado-por-balear-a-una-mujer-para-robarle-el-auto-20231020-0046.html",]
urls_futbol=["https://www.rosario3.com/deportes/Racing-recupera-a-un-ex-Rosario-Central-para-recibir-a-Newells-por-la-punta-20230918-0049.html","https://www.rosario3.com/deportes/Duelo-de-punteros-e-invictos-Newells-y-Racing-cara-a-cara-en-Avellaneda-20230919-0065.html","https://www.rosario3.com/deportes/Todos-los-datos-en-la-previa-al-choque-entre-Newells-y-Estudiantes-de-La-Plata-20230923-0029.html","https://www.rosario3.com/deportes/Heinze-emocionado-en-el-banderazo-Ojala-podamos-darle-una-alegria-a-esta-gente-20230928-0045.html","https://www.rosario3.com/deportes/Se-paraliza-la-ciudad-Central-y-Newells-vuelven-a-cruzarse-en-una-nueva-edicion-del-clasico-rosarino-20230929-0067.html","https://www.rosario3.com/deportes/OConnor-y-los-secretos-de-Miguel-Russo-en-los-clasicos-Me-dijo-que-lo-juegue-como-un-partido-mas-20231004-0046.html","https://www.rosario3.com/deportes/Tras-la-victoria-en-el-clasico-Central-vuelve-al-Gigante-y-se-mide-ante-el-bravo-Huracan-20231005-0048.html","https://www.rosario3.com/deportes/Seguimiento-individual-canalla-Central-crece-desde-abajo-con-Mallo-y-Quintana-20231006-0059.html","https://www.rosario3.com/deportes/Jorge-Broun-hablo-de-su-futuro-en-Central-los-objetivos-en-la-recta-final-y-un-posible-regreso-de-Di-Maria-20231017-0037.html","https://www.rosario3.com/deportes/Di-Maria-volvio-a-hablar-de-su-regreso-a-Central-Obvio-que-esa-opcion-esta-20231017-0044.html","https://www.rosario3.com/deportes/Di-Maria-volvio-a-hablar-de-su-regreso-a-Central-Obvio-que-esa-opcion-esta-20231017-0044.html","https://www.rosario3.com/deportes/Quien-le-deja-su-lugar-a-Malcorra-la-gran-duda-de-Russo-para-recibir-a-Velez-20231018-0026.html","https://www.rosario3.com/deportes/Central-vuelve-al-Gigante-de-Arroyito-y-choca-ante-Velez-con-la-idea-de-meterse-entre-los-cuatro-primeros-20231018-0074.html","https://www.rosario3.com/deportes/Miguel-Russo-Esto-es-partido-a-partido-no-se-puede-hablar-de-las-aspiraciones-20231019-0060.html","https://www.rosario3.com/deportes/Copa-Santa-Fe-Central-paso-a-la-final-tras-ganarle-a-Sportivo-Las-Parejas-20231021-0010.html","https://www.rosario3.com/deportes/Newells-prepara-la-celebracion-de-sus-120-anos-con-una-gran-fiesta-20231018-0084.html","https://www.rosario3.com/deportes/Todos-los-datos-en-la-previa-al-choque-entre-Tigre-y-Newells-en-Victoria-20231019-0020.html","https://www.rosario3.com/deportes/Newells-choca-ante-Tigre-en-su-tercera-visita-consecutiva-y-busca-acentuar-la-recuperacion-20231019-0046.html","https://www.rosario3.com/deportes/Los-11-Titulares-de-Agustin-Alayes-el-jugador-al-que-le-faltaba-una-rectificacion-y-el-que-lo-hizo-renegar-por-inmaduro-20231019-0048.html","https://www.rosario3.com/deportes/Mendez-sobre-su-asistencia-en-el-primero-de-Newells-Por-suerte-me-tome-ese-tiempo-y-lo-vi-20231020-0052.html"]
urls_politica=["https://www.rosario3.com/politica/De-cara-al-balotaje-Milei-toma-el-discurso-de-grieta-de-Bullrich-El-kirchnerismo-es-lo-peor-que-le-paso-al-pais-20231022-0063.html","https://www.rosario3.com/politica/Massa-No-a-la-idea-de-amigo-enemigo-la-grieta-se-murio-20231022-0065.html","https://www.rosario3.com/politica/Masas-para-Milei-la-libertad-preocupada-y-el-pato-de-peluche-que-todos-quieren-20231023-0004.html","https://www.rosario3.com/politica/Massa-Milei-y-el-pendulo-frenetico-una-excursion-a-la-intimidad-de-dos-universos-en-pugna-20231023-0009.html","https://www.rosario3.com/politica/Las-felicitaciones-de-Pullaro-a-Massa-y-Milei-sin-inclinarse-por-ninguno-20231023-0018.html","https://www.rosario3.com/politica/El-dia-despues-Milei-se-mete-en-la-interna-de-Juntos-para-sumar-votos-anti-K-y-tilda-de-traidores-a-los-radicales-20231023-0026.html","https://www.rosario3.com/politica/El-peronismo-en-busca-del-voto-que-asegure-el-balotaje-Que-nadie-se-suba-al-pony-20231023-0034.html","https://www.rosario3.com/politica/Mas-por-espanto-que-por-amor-Bregman-y-el-socialismo-abren-la-puerta-del-apoyo-a-Massa-20231023-0030.html","https://www.rosario3.com/politica/Masa-o-Milei-crearon-un-simulador-para-especular-quien-podria-ganar-el-balotaje-20231023-0039.html","https://www.rosario3.com/politica/Balotaje-Massa-Milei-se-viene-el-debate-final-mano-a-mano-20231023-0055.html","https://www.rosario3.com/politica/Argentina-vota-presidente-en-una-eleccion-que-define-mucho-mas-que-los-proximos-cuatro-anos-20231018-0034.html","https://www.rosario3.com/politica/Voto-Myriam-Bregman-Hay-otra-salida-para-la-crisis-no-todo-es-ajuste-al-pueblo-trabajador-20231022-0009.html","https://www.rosario3.com/politica/Rossi-voto-en-Rosario-Vamos-a-hacer-una-muy-buena-primera-vuelta-20231022-0013.html","https://www.rosario3.com/politica/Voto-Juan-Schiaretti-y-manifesto-la-confianza-en-el-interior-productivo-20231022-0017.html","https://www.rosario3.com/politica/Massa-Creemos-que-va-a-ser-una-excelente-jornada-20231022-0022.html","https://www.rosario3.com/politica/Omar-Perotti-En-estas-elecciones-se-ponen-en-juego-40-anos-de-democracia-20231022-0020.html","https://www.rosario3.com/politica/Javier-Milei-Mi-deseo-es-poner-de-pie-a-la-Argentina-20231022-0023.html","https://www.rosario3.com/politica/Bullrich-Tuvimos-muchas-denuncias-de-falta-de-boletas-pero-nosotros-traeremos-tranquilidad-20231022-0025.html","https://www.rosario3.com/politica/Cristina-Kirchner-Mi-responsabilidad-es-la-de-presidenta-del-Senado-no-defino-politicas-20231022-0026.html","https://www.rosario3.com/politica/Mauricio-Macri-asevero-que-se-puede-salir-para-adelante-y-opino-que-habra-balotaje-20231022-0027.html"]
urls_tecnologia=["https://www.rosario3.com/tecnologia/Pantalla-renovada-y-un-nuevo-boton-configurable-que-se-sabe-sobre-el-iPhone-15-a-un-mes-de-su-presentacion-oficial-20230801-0057.html","https://www.rosario3.com/tecnologia/Ciberataque-al-Pami-estamos-preparados-para-la-historia-clinica-digital-20230804-0049.html","https://www.rosario3.com/tecnologia/La-paradoja-de-la-comodidad-riesgos-y-reflexiones-sobre-la-identificacion-biometrica-20230811-0051.html","https://www.rosario3.com/tecnologia/La-inteligencia-artificial-permitio-ahorrar-al-menos-medio-ano-en-investigaciones-de-fuerzas-federales-20230812-0011.html","https://www.rosario3.com/tecnologia/Se-prepara-el-primer-Foro-Internacional-de-Inteligencia-Artificial-de-la-UTN-Estas-herramientas-deben-ser-complementarias-y-enriquecedoras-20230822-0049.html","https://www.rosario3.com/tecnologia/Google-advirtio-que-comenzara-a-borrar-cuentas-que-no-registren-actividad-desde-cuando-y-como-evitarlo-20230822-0057.html","https://www.rosario3.com/tecnologia/Mas-cambios-en-X-Elon-Musk-le-pidio-a-los-desarrolladores-que-eliminen-los-titulos-que-se-muestran-al-incluir-enlaces-20230822-0052.html","https://www.rosario3.com/tecnologia/Meta-presento-un-nuevo-modelo-de-traduccion-de-voz-y-texto-basado-en-inteligencia-artificial-20230822-0059.html","https://www.rosario3.com/tecnologia/El-40-de-la-mano-de-obra-mundial-debera-especializarse-para-hacer-frente-al-avance-de-la-inteligencia-artificial-20230823-0052.html","https://www.rosario3.com/tecnologia/Meta-presento-Code-Llama-su-nuevo-modelo-de-inteligencia-artificial-capaz-de-escribir-y-corregir-codigo-de-programacion-20230825-0037.html","https://www.rosario3.com/tecnologia/WhatsApp-esta-probando-un-rediseno-de-su-interfaz-y-una-opcion-para-crear-stickers-con-inteligencia-artificial-20230927-0046.html","https://www.rosario3.com/tecnologia/Como-funciona-Artifact-la-aplicacion-de-noticias-que-los-usuarios-definen-como-el-TikTok-del-texto-20230927-0056.html","https://www.rosario3.com/tecnologia/Es-hora-de-renovar-tu-celular-Como-hacer-una-eleccion-inteligente-sin-pagar-de-mas-20230929-0053.html","https://www.rosario3.com/tecnologia/Cuales-son-las-nuevas-funciones-de-Android-14-fondos-de-pantalla-generados-con-IA-y-mayor-control-sobre-datos-personales-20231009-0041.html","https://www.rosario3.com/tecnologia/Moneda-digital-argentina-entre-la-tecnologia-y-el-autoritarismo-20231006-0043.html","https://www.rosario3.com/tecnologia/Advierten-que-el-iPhone-15-se-calienta-por-encima-de-los-niveles-normales-la-explicacion-de-Apple-20231002-0063.html","https://www.rosario3.com/tecnologia/Google-anuncio-el-lanzamiento-de-una-funcion-de-busqueda-basada-en-IA-pensada-para-medicos-permite-filtrar-datos-de-los-pacientes-20231010-0060.html","https://www.rosario3.com/tecnologia/Existe-la-tecnologia-para-reconstruir-al-Hombre-Nuclear-y-esta-mas-cerca-de-lo-que-se-puede-imaginar-20231012-0038.html","https://www.rosario3.com/tecnologia/Robots-asesinos-como-la-IA-esta-redefiniendo-la-guerra-moderna-20231020-0038.html","https://www.rosario3.com/tecnologia/Google-alude-a-las-elecciones-en-Argentina-con-un-doodle-en-celeste-y-blanco-20231022-0021.html"]

df_policiales = construir_dataset("Policiales", urls_policiales)
df_futbol = construir_dataset("Futbol", urls_futbol)
df_politica = construir_dataset("Politica", urls_politica)
df_tecnologia = construir_dataset("Tecnologia", urls_tecnologia)

df_total = pd.concat([df_policiales, df_futbol,df_politica,df_tecnologia], ignore_index=True)

df_total.to_csv("dataset_tp2.csv", index=False)
